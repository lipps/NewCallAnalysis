# 销售通话质检系统

基于AI的销售通话质检与分析系统，使用LangGraph工作流引擎、向量检索和大语言模型实现高性能的通话质量分析。\n\n## 🎯 功能特性\n\n### 核心分析模块\n- **破冰要点检测**: 专业身份、帮助价值、时间说明、公司背景、免费讲解\n- **功能演绎检测**: BS点、周期共振、控盘资金、步步高、价值量化、客户股票分析\n- **过程指标统计**: 通话时长、互动频率、成交约访情况\n- **客户侧分析**: 客户态度、问题提取、价值认同度评估\n- **标准动作统计**: 各项销售动作的执行情况和次数统计\n\n### 技术亮点\n- **LangGraph工作流**: 并行处理、状态管理、错误恢复\n- **向量检索引擎**: 语义相似度匹配、知识库管理\n- **规则引擎**: 关键词+正则表达式快速检测\n- **LLM验证**: 智能判定和证据提取\n- **可视化Dashboard**: 实时分析、批量处理、统计展示\n\n## 🚀 快速开始\n\n### 环境要求\n- Python 3.8+\n- OpenAI API密钥（或兼容的LLM服务）\n\n### 安装依赖\n```bash\npip install -r requirements.txt\n```\n\n### 环境配置\n```bash\ncp .env.example .env\n# 编辑.env文件，填入你的API密钥\n```\n\n### 使用方式\n\n#### 1. 命令行分析\n```bash\n# 单个通话分析\npython main.py analyze --text \"销售：您好，我是益盟操盘手专员...\"\n\n# 从文件分析\npython main.py analyze --file input.txt --output result.json\n\n# 批量分析\npython main.py batch --file batch_input.json --output batch_results.json\n```\n\n#### 2. API服务\n```bash\n# 启动API服务器\npython main.py server --host 0.0.0.0 --port 8000\n\n# 访问API文档\n# http://localhost:8000/docs\n```\n\n#### 3. 可视化Dashboard\n```bash\n# 启动Dashboard\npython main.py dashboard\n\n# 访问Dashboard\n# http://localhost:8501\n```\n\n## 📋 API接口\n\n### 单次分析\n```http\nPOST /analyze\nContent-Type: application/json\n\n{\n  \"call_id\": \"call_001\",\n  \"transcript\": \"通话转写文本...\",\n  \"customer_id\": \"customer_001\",\n  \"sales_id\": \"sales_001\"\n}\n```\n\n### 批量分析\n```http\nPOST /analyze/batch\nContent-Type: application/json\n\n{\n  \"batch_id\": \"batch_001\",\n  \"calls\": [\n    {\n      \"call_id\": \"call_001\",\n      \"transcript\": \"...\"\n    }\n  ]\n}\n```\n\n### 质量指标\n```http\nPOST /analyze/quality\nContent-Type: application/json\n\n[CallAnalysisResult对象]\n```\n\n## 📊 输出格式\n\n系统输出标准JSON格式，包含以下字段：\n\n```json\n{\n  \"call_id\": \"通话ID\",\n  \"icebreak\": {\n    \"professional_identity\": {\"hit\": true, \"evidence\": \"我是益盟操盘手专员\", \"confidence\": 0.95},\n    \"value_help\": {\"hit\": true, \"evidence\": \"帮您把握买卖点机会\", \"confidence\": 0.88},\n    // ...\n  },\n  \"演绎\": {\n    \"bs_explained\": {\"hit\": true, \"evidence\": \"B点是买入信号\", \"confidence\": 0.92},\n    // ...\n  },\n  \"process\": {\n    \"explain_duration_min\": 12.5,\n    \"interaction_rounds_per_min\": 1.8,\n    \"deal_or_visit\": false\n  },\n  \"customer\": {\n    \"summary\": \"认可：讲的功能确实有帮助\",\n    \"questions\": [\"这个功能收费吗？\"],\n    \"value_recognition\": \"是\"\n  },\n  \"actions\": {\n    \"bs_explained\": {\"executed\": true, \"count\": 2},\n    // ...\n  }\n}\n```\n\n## 🔧 系统架构\n\n```\n├── src/\n│   ├── models/          # 数据模型和Schema\n│   ├── processors/      # 各分析模块处理器\n│   ├── engines/         # 核心引擎（向量、规则、LLM）\n│   ├── workflows/       # LangGraph工作流\n│   ├── api/            # FastAPI接口\n│   ├── dashboard/      # Streamlit可视化\n│   ├── config/         # 配置管理\n│   └── utils/          # 工具函数\n├── tests/              # 测试用例\n├── data/               # 数据存储\n└── logs/               # 日志文件\n```\n\n## ⚡ 性能优化\n\n### 并行处理\n- LangGraph并行节点执行\n- 异步批量处理\n- 多引擎协同工作\n\n### 缓存策略\n- 规则检测结果缓存\n- 向量检索缓存\n- LLM响应缓存\n\n### 资源管理\n- 连接池管理\n- 内存优化\n- 错误恢复机制\n\n## 🧪 测试\n\n```bash\n# 运行所有测试\npytest tests/ -v\n\n# 运行特定测试\npytest tests/test_workflow.py -v\n\n# 性能测试\npytest tests/test_workflow.py::TestPerformance -v\n```\n\n## 📈 监控指标\n\n- **系统性能**: 处理速度、并发能力、资源使用\n- **分析质量**: 置信度分布、准确率、覆盖率\n- **业务指标**: 破冰成功率、演绎完整度、客户满意度\n\n## 🔨 开发指南\n\n### 添加新的检测规则\n```python\n# 在src/config/settings.py中添加\nDETECTION_RULES = {\n    \"新类别\": {\n        \"新要点\": {\n            \"keywords\": [\"关键词1\", \"关键词2\"],\n            \"patterns\": [r\"正则表达式1\", r\"正则表达式2\"]\n        }\n    }\n}\n```\n\n### 扩展处理器\n```python\n# 继承基础处理器类\nclass CustomProcessor(BaseProcessor):\n    async def analyze(self, processed_text, config):\n        # 实现自定义分析逻辑\n        pass\n```\n\n### 自定义工作流\n```python\n# 修改src/workflows/call_analysis_workflow.py\n# 添加新的处理节点和边连接\n```\n\n## 📞 技术支持\n\n如有问题或建议，请提交Issue或联系开发团队。\n\n## 📄 许可证\n\nMIT License"